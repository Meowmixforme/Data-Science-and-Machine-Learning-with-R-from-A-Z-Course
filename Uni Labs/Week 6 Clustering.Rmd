---
title: "Week 6: Clustering"
output: html_notebook
---

# Load Libraries

```{r}

library(tidyverse)
library(corrplot)
library(gridExtra)
library(GGally)
library(knitr)

```


# Read the stats

```{r}

wines <- read.csv("Wine.csv")

```


# Remove the Type column

```{r}

wines <- wines[, -14] # Remove the 'labelled' column Customer_Segment

```

# Explore the data

```{r}
kable(head(wines))
```


# Data analysis

```{r}

# Histogram for each Attribute

wines %>%
  gather(Attributes, value, 1:13) %>%
  ggplot(aes(x = value, fill = Attributes)) +
  geom_histogram(colour = "black", show.legend = FALSE) +
  facet_wrap(~ Attributes, scales = "free_x") +
  labs(x = "Values", y = "Frequency",
       title = "Wines Attributes - Histograms") +
  theme_bw()

```

# Density plot for each attribute

```{r}

wines %>%
  gather(Attributes, value, 1:13) %>%
  ggplot(aes(x = value, fill = Attributes)) +
  geom_density(colour = "black", alpha =0.5, show.legend = FALSE) +
  facet_wrap(~ Attributes, scales = "free_x") +
  labs(x = "Values", y = "Density",
       title = "Wines Attributes - Density plots")+
  theme_bw()



```

# Boxplot For each Attribute

```{r}

wines %>%
  gather(Attributes, values, c(1:4, 6:12)) %>%
  ggplot(aes(x = reorder(Attributes, values, FUN = median), y = values, fill = Attributes)) +
  geom_boxplot(show.legend = FALSE) +
  labs(title = "Wines Attributes BOxplots") +
  theme_bw() +
  theme(axis.title.y = element_blank(),
        axis.title.x = element_blank()) +
  ylim(0, 35) +
  coord_flip()

```

# Correlation Matrix

```{r}

corrplot(cor(wines), type = "upper", method = "ellipse", tl.cex = 0.9)

```

# Relationship between Phenols and Flavanoids

```{r}

ggplot(wines, aes(x = Phenols, y = Flavanoids)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Wines Attributes",
       subtitle = "Relationship between Phenols and Flavanoids") +
  theme_bw()

```

# Data Preparation

```{r}

# Normalization

winesNorm <- as.data.frame(scale(wines))

# Original data

p1 <- ggplot(wines, aes(x = Alcohol, y = Malic.acid)) +
  geom_point()
labs(title = "Original data") +
  theme_bw()



# Normalized data

p2 <- ggplot(winesNorm, aes(x = Alcohol, y = Malic.acid)) +
  geom_point()
labs(title = "Normalized data") +
  theme_bw()

# Subplot

grid.arrange(p1, p2, ncol = 2)

```

# k-means execution

```{r}


```

